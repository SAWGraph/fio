# FIO Basics
# CQ 6
# Retrieve all facilities with NAICS Industry Code 562212 and return their location as S2 cell (approxomate location) and the specified point geometry for them. 

PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

PREFIX fio: <http://sawgraph.spatialai.org/v1/fio#>
prefix naics: <http://sawgraph.spatialai.org/v1/fio/naics#>
PREFIX us_frs: <http://sawgraph.spatialai.org/v1/us-frs#>

PREFIX geo: <http://www.opengis.net/ont/geosparql#>
PREFIX kwg-ont: <http://stko-kwg.geog.ucsb.edu/lod/ontology/>


SELECT * WHERE {
	?fac rdf:type fio:Facility ;
		 fio:ofIndustry ?code ;
		 kwg-ont:sfWithin ?fac_s2 ;
		 geo:hasGeometry/geo:asWKT ?fac_wkt .
	?s2 a kwg-ont:S2Cell_Level13.
	# also retrieve any labels associated with the facility and industry 
	OPTIONAL { ?fac rdfs:label ?faclabel . }
	OPTIONAL { ?code rdfs:label ?ind . }
	FILTER (?code IN (naics:NAICS-Industry-Code-562212))
}
